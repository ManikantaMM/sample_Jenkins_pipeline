pipeline{
    agent any

    parameters{
        string(description: "Enter controller name",name: "controller_name",defaultValue="None")
        choice(
            choices: [
                "None","us-west-2", "ap-east-1", "af-south-1", "ap-south-1", "ap-southeast-2",
                "ap-southeast-1", "eu-central-1", "eu-west-2", "sa-east-1"
            ],
            description: "Select region name",
            name: "region_name"
        )
        string(description:"Enter start date in the format YYYY-MM-DD",name: "startDate",defaultValue="None")
        string(description:"Enter end date in the format YYYY-MM-DD",name: "EndDate",defaultValue="None")
    }

    stages{
        stage('Build'){
            steps{
                script{
                    sh 'python -m venv venv'
                    sh 'source venv/bin/activate'
                    sh "python3 amis_in_between_specified_dates.py --host_name ${params.controller_name} --region_name ${params.region_name} ${params.startDate} ${params.EndDate}"
                    sh 'deactivate'
                }
            }
        }
    }
}
